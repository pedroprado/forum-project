{"ast":null,"code":"var _jsxFileName = \"/home/pedrolocal/Desktop/Projects/ForumProject/forum-app/src/containers/QuestionsPage.js\";\nimport React, { PureComponent } from 'react';\nimport QuestionsSummary from '../components/QuestionsSummary/QuestionsSummary';\nimport QuestionDetailPage from './QuestionDetailPage';\nimport './QuestionsPage.css';\nimport { listQuestions, createQuestion } from '../services/Question';\nimport { findAllByQuestionId } from '../services/Answer';\n\nclass QuestionsPage extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.fetchQuestions = async () => {\n      const questions = await listQuestions();\n      this.setState({\n        questions: [...questions]\n      });\n    };\n\n    this.saveQuestion = async (newQuestion, username) => {\n      const new_question = {\n        text: newQuestion,\n        user: username\n      };\n      await createQuestion(new_question);\n    };\n\n    this.fetchQuestionsNumberOfAnswers = async () => {\n      const questions = [...this.state.questions];\n      let new_questions = [];\n\n      for (const question of questions) {\n        const fetch_answers = await findAllByQuestionId(question.id);\n        const new_question = { ...question,\n          answers: [...fetch_answers]\n        };\n        new_questions.push(new_question);\n      }\n\n      ;\n      this.setState({\n        questions: [...new_questions]\n      });\n    };\n\n    this.onBackButtonClicked = () => {\n      this.setState({\n        viewQuestionDetail: false\n      });\n    };\n\n    this.onQuestionItemSelected = id => {\n      const questionItemSelected = this.state.questions.filter(question => question.id === id);\n      this.setState({\n        selectedQuestionItem: questionItemSelected[0]\n      });\n      this.setState({\n        viewQuestionDetail: true\n      });\n    };\n\n    this.onNewQuestionChange = event => {\n      this.setState({\n        newQuestion: event.target.value\n      });\n    };\n\n    this.onNewQuestionSubmit = async (event, username) => {\n      event.preventDefault();\n\n      if (window.confirm('Tem certeza que deseja enviar pergunta?')) {\n        await this.saveQuestion(this.state.newQuestion, username);\n        await this.fetchQuestions();\n        this.setState({\n          newQuestion: ''\n        });\n      }\n\n      this.fetchQuestionsNumberOfAnswers();\n    };\n\n    this.componentDidUpdate = async (prevProps, prevState) => {\n      if (prevState.viewQuestionDetail !== this.state.viewQuestionDetail) {\n        console.log(\"atualizando\");\n        await this.fetchQuestions();\n        this.fetchQuestionsNumberOfAnswers();\n      }\n    };\n\n    this.componentDidMount = async () => {\n      await this.fetchQuestions();\n      this.fetchQuestionsNumberOfAnswers();\n    };\n\n    this.state = {\n      questions: [],\n      selectedQuestionItem: {},\n      viewQuestionDetail: false,\n      newQuestion: ''\n    };\n  }\n\n  render() {\n    const {\n      questions,\n      newQuestion,\n      viewQuestionDetail,\n      selectedQuestionItem\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"QuestionsPage\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 12\n      }\n    }, viewQuestionDetail ? /*#__PURE__*/React.createElement(QuestionDetailPage, {\n      backButtonClicked: this.onBackButtonClicked,\n      selectedQuestion: selectedQuestionItem,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 7\n      }\n    }) : /*#__PURE__*/React.createElement(QuestionsSummary, {\n      onQuestionSelected: this.onQuestionItemSelected,\n      newQuestion: newQuestion,\n      onNewQuestionChange: this.onNewQuestionChange,\n      onNewQuestionSubmit: this.onNewQuestionSubmit,\n      questionsSummaryList: questions,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 7\n      }\n    }));\n  }\n\n}\n\nexport default QuestionsPage;","map":{"version":3,"sources":["/home/pedrolocal/Desktop/Projects/ForumProject/forum-app/src/containers/QuestionsPage.js"],"names":["React","PureComponent","QuestionsSummary","QuestionDetailPage","listQuestions","createQuestion","findAllByQuestionId","QuestionsPage","constructor","props","fetchQuestions","questions","setState","saveQuestion","newQuestion","username","new_question","text","user","fetchQuestionsNumberOfAnswers","state","new_questions","question","fetch_answers","id","answers","push","onBackButtonClicked","viewQuestionDetail","onQuestionItemSelected","questionItemSelected","filter","selectedQuestionItem","onNewQuestionChange","event","target","value","onNewQuestionSubmit","preventDefault","window","confirm","componentDidUpdate","prevProps","prevState","console","log","componentDidMount","render"],"mappings":"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","sourcesContent":["import React, { PureComponent } from 'react';\nimport QuestionsSummary from '../components/QuestionsSummary/QuestionsSummary';\nimport QuestionDetailPage from './QuestionDetailPage';\nimport './QuestionsPage.css'\n\nimport { listQuestions, createQuestion } from '../services/Question';\nimport { findAllByQuestionId } from '../services/Answer';\n\n\nclass QuestionsPage extends PureComponent{\n\n    constructor(props) {\n        super(props);\n        this.state = {\n\t\t\tquestions: [],\n\t\t  \tselectedQuestionItem: {},\n\t\t\tviewQuestionDetail: false,\n\t\t\tnewQuestion: ''\n        };\n    }\n\n\tfetchQuestions = async () => {\n\t\tconst questions = await listQuestions();\n\t\tthis.setState({ questions: [...questions]});\t\n\t};\n\n\tsaveQuestion = async (newQuestion, username) => {\n\t\tconst new_question = { text: newQuestion, user: username }\n\t\tawait createQuestion(new_question);\n\t}\n\n\tfetchQuestionsNumberOfAnswers = async () =>{\n\t\tconst questions = [...this.state.questions];\n\t\tlet new_questions = [];\n\t\tfor(const question of questions) {\n\t\t\tconst fetch_answers = await findAllByQuestionId(question.id);\n\t\t\tconst new_question = { ...question, answers: [...fetch_answers]};\n\t\t\tnew_questions.push(new_question);\n\t\t};\n\t\tthis.setState({ questions: [...new_questions]});\t\n\t};\n\n\n\tonBackButtonClicked = () =>{\n\t\tthis.setState({ viewQuestionDetail: false});\n\t};\n\t  \n\tonQuestionItemSelected = (id)=>{\n\t\tconst questionItemSelected = this.state.questions.filter( question => question.id === id);\n\t\tthis.setState({selectedQuestionItem: questionItemSelected[0]});\n\t\tthis.setState({ viewQuestionDetail: true});\n\t};\n\n\tonNewQuestionChange = (event) =>{\n\t\tthis.setState({newQuestion: event.target.value});\n\t}\n\n\tonNewQuestionSubmit = async (event, username) => {\n\t\tevent.preventDefault();\n\t\tif (window.confirm('Tem certeza que deseja enviar pergunta?')){\n\t\t\tawait this.saveQuestion(this.state.newQuestion, username);\n\t\t\tawait this.fetchQuestions();\n\t\t\tthis.setState({ newQuestion: ''});\n\t\t}\n\t\tthis.fetchQuestionsNumberOfAnswers();\n\t};\n\n\tcomponentDidUpdate = async(prevProps, prevState) =>{\n\t\tif(prevState.viewQuestionDetail !== this.state.viewQuestionDetail){\n\t\t\tconsole.log(\"atualizando\")\n\t\t\tawait this.fetchQuestions();\n\t\t\tthis.fetchQuestionsNumberOfAnswers();\n\t\t}\n\t};\n\n    componentDidMount = async() => {\n\t\tawait this.fetchQuestions();\n\t\tthis.fetchQuestionsNumberOfAnswers();\n    }\n\n    render(){\n\t\tconst { questions, newQuestion, viewQuestionDetail , selectedQuestionItem} = this.state;\n        return(\n           <div className='QuestionsPage'>\n\t\t\t   {viewQuestionDetail? \n\t\t\t   <QuestionDetailPage \n\t\t\t\t\tbackButtonClicked={this.onBackButtonClicked}\n\t\t\t\t\tselectedQuestion={selectedQuestionItem} /> \n\t\t\t   :  \n\t\t\t   <QuestionsSummary\n\t\t\t\t\tonQuestionSelected={this.onQuestionItemSelected}\n\t\t\t\t\tnewQuestion={newQuestion} \n\t\t\t\t\tonNewQuestionChange={this.onNewQuestionChange}\n\t\t\t\t\tonNewQuestionSubmit = {this.onNewQuestionSubmit}   \n                \tquestionsSummaryList={questions} /> }\n           </div>\n        );\n    \n    };\n}\n\nexport default QuestionsPage;"]},"metadata":{},"sourceType":"module"}